version: '3.8'

services:
  chillproxy:
    image: chillproxy:latest
    container_name: chillproxy
    ports:
      - "8080:8080"
    environment:
      # Server
      - STREMTHRU_PORT=8080
      - STREMTHRU_BASE_URL=http://localhost:8080
      - STREMTHRU_ENV=prod

      # Chillstreams Integration
      - CHILLSTREAMS_API_URL=http://chillstreams-app:3000
      - CHILLSTREAMS_API_KEY=test_internal_key_phase3_2025
      - ENABLE_CHILLSTREAMS_AUTH=true
      - CHILLSTREAMS_DATABASE_URL=postgresql://postgres:Iamwho06!@chillstreams-postgres:5432/chillstreams

      # Database
      - STREMTHRU_DATABASE_URI=sqlite:///app/data/stremthru.db
      - STREMTHRU_DATA_DIR=/app/data

      # Features - enable torz addon
      - STREMTHRU_FEATURE=stremio_torz

      # TorBox API Key for Prowlarr integration
      - TORBOX_API_KEY=6748e313-ff29-4a26-80c1-34e8da4b79ee

      # Logging - Set to DEBUG to see Chillstreams integration logs
      - STREMTHRU_LOG_LEVEL=DEBUG
      - STREMTHRU_LOG_FORMAT=json

    volumes:
      - chillproxy-data:/app/data
    networks:
      - chillstreams-network
    restart: unless-stopped

volumes:
  chillproxy-data:

networks:
  chillstreams-network:
    external: true

